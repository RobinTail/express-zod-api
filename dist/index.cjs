"use strict";var Fo=Object.create;var _e=Object.defineProperty;var Bo=Object.getOwnPropertyDescriptor;var qo=Object.getOwnPropertyNames;var $o=Object.getPrototypeOf,Vo=Object.prototype.hasOwnProperty;var Go=(e,t)=>{for(var r in t)_e(e,r,{get:t[r],enumerable:!0})},ar=(e,t,r,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of qo(t))!Vo.call(e,n)&&n!==r&&_e(e,n,{get:()=>t[n],enumerable:!(o=Bo(t,n))||o.enumerable});return e};var R=(e,t,r)=>(r=e!=null?Fo($o(e)):{},ar(t||!e||!e.__esModule?_e(r,"default",{value:e,enumerable:!0}):r,e)),_o=e=>ar(_e({},"__esModule",{value:!0}),e);var zs={};Go(zs,{BuiltinLogger:()=>ze,DependsOnMethod:()=>we,Documentation:()=>yt,DocumentationError:()=>v,EndpointsFactory:()=>Ce,InputValidationError:()=>H,Integration:()=>Rt,Middleware:()=>$,MissingPeerError:()=>he,OutputValidationError:()=>G,ResultHandler:()=>Ae,RoutingError:()=>te,ServeStatic:()=>Ze,arrayEndpointsFactory:()=>Ir,arrayResultHandler:()=>ct,attachRouting:()=>oo,createConfig:()=>lr,createServer:()=>no,defaultEndpointsFactory:()=>wr,defaultResultHandler:()=>Pe,ez:()=>Do,getExamples:()=>q,getMessageFromError:()=>B,getStatusCodeFromError:()=>De,testEndpoint:()=>Ao,testMiddleware:()=>Po});module.exports=_o(zs);var I=require("ramda"),ne=require("zod");var pr=require("http-errors"),Qe=require("ramda"),cr=require("zod");var te=class extends Error{name="RoutingError"},v=class extends Error{name="DocumentationError";constructor({message:t,method:r,path:o,isResponse:n}){let i=`${t}
Caused by ${n?"response":"input"} schema of an Endpoint assigned to ${r.toUpperCase()} method of ${o} path.`;super(i)}},Ye=class extends Error{name="IOSchemaError"},G=class extends Ye{constructor(r){super(B(r));this.originalError=r}name="OutputValidationError"},H=class extends Ye{constructor(r){super(B(r));this.originalError=r}name="InputValidationError"},_=class extends Error{constructor(r,o){super(r);this.originalError=o}name="ResultHandlerError"},he=class extends Error{name="MissingPeerError";constructor(t){super(`Missing peer dependency: ${t}. Please install it to use the feature.`)}};var C={json:"application/json",upload:"multipart/form-data",raw:"application/octet-stream"};var Yo=e=>{let r=(e.header("content-type")||"").toLowerCase().startsWith(C.upload);return"files"in e&&r},Pt={get:["query","params"],post:["body","params","files"],put:["body","params"],patch:["body","params"],delete:["query","params"]},Qo=["body","query","params"],Ct=e=>e.method.toLowerCase(),zt=e=>e.startsWith("x-"),Jo=e=>(0,Qe.pickBy)((t,r)=>zt(r),e),Je=(e,t={})=>{let r=Ct(e);return r==="options"?{}:(t[r]||Pt[r]||Qo).filter(o=>o==="files"?Yo(e):!0).map(o=>o==="headers"?Jo(e[o]):e[o]).reduce((o,n)=>({...o,...n}),{})},xe=e=>e instanceof Error?e:new Error(String(e)),B=e=>e instanceof cr.z.ZodError?e.issues.map(({path:t,message:r})=>(t.length?[t.join("/")]:[]).concat(r).join(": ")).join("; "):e instanceof G?`output${e.originalError.issues[0]?.path.length>0?"/":": "}${e.message}`:e.message,De=e=>(0,pr.isHttpError)(e)?e.statusCode:e instanceof H?400:500,wt=({logger:e,request:t,input:r,error:o,statusCode:n})=>{n===500&&e.error(`Internal server error
${o.stack}
`,{url:t.url,payload:r})},q=({schema:e,variant:t="original",validate:r=t==="parsed"})=>{let o=e._def[h]?.examples||[];if(!r&&t==="original")return o;let n=[];for(let i of o){let a=e.safeParse(i);a.success&&n.push(t==="parsed"?a.data:i)}return n},re=(e,t,r)=>e.length&&t.length?(0,Qe.xprod)(e,t).map(r):e.concat(t),Ke=e=>"coerce"in e._def&&typeof e._def.coerce=="boolean"?e._def.coerce:!1,It=e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase(),M=(...e)=>e.flatMap(t=>t.split(/[^A-Z0-9]/gi)).flatMap(t=>t.replaceAll(/[A-Z]+/g,r=>`/${r}`).split("/")).map(It).join(""),We=(e,t)=>{try{return typeof e.parse(t)}catch{return}},oe=e=>typeof e=="object"&&e!==null;var Xe=require("ramda"),h=Symbol.for("express-zod-api"),et=e=>{let t=e.describe(e.description);return t._def[h]=(0,Xe.clone)(t._def[h])||{examples:[]},t},dr=(e,t)=>{if(!(h in e._def))return t;let r=et(t);return r._def[h].examples=re(r._def[h].examples,e._def[h].examples,([o,n])=>typeof o=="object"&&typeof n=="object"?(0,Xe.mergeDeepRight)({...o},{...n}):n),r};var Wo=function(e){let t=et(this);return t._def[h].examples.push(e),t},Xo=function(e){let t=et(this);return t._def[h].defaultLabel=e,t},en=function(e){return new ne.z.ZodBranded({typeName:ne.z.ZodFirstPartyTypeKind.ZodBranded,type:this,description:this._def.description,errorMap:this._def.errorMap,[h]:{examples:[],...(0,I.clone)(this._def[h]),brand:e}})},tn=function(e){let t=typeof e=="function"?e:(0,I.pipe)(I.toPairs,(0,I.map)(([n,i])=>(0,I.pair)(e[String(n)]||n,i)),I.fromPairs),r=t((0,I.clone)(this.shape)),o=ne.z.object(r)[this._def.unknownKeys]();return this.transform(t).pipe(o)};h in globalThis||(globalThis[h]=!0,Object.defineProperties(ne.z.ZodType.prototype,{example:{get(){return Wo.bind(this)}},brand:{set(){},get(){return en.bind(this)}}}),Object.defineProperty(ne.z.ZodDefault.prototype,"label",{get(){return Xo.bind(this)}}),Object.defineProperty(ne.z.ZodObject.prototype,"remap",{get(){return tn.bind(this)}}));function lr(e){return e}var zr=require("zod");var kt=require("zod");var A=require("node:assert/strict");var be=require("zod");var tt=e=>!isNaN(e.getTime());var se=Symbol("DateIn"),mr=()=>be.z.union([be.z.string().date(),be.z.string().datetime(),be.z.string().datetime({local:!0})]).transform(t=>new Date(t)).pipe(be.z.date().refine(tt)).brand(se);var ur=require("zod");var ie=Symbol("DateOut"),fr=()=>ur.z.date().refine(tt).transform(e=>e.toISOString()).brand(ie);var Fe=require("zod"),D=Symbol("File"),yr=Fe.z.custom(e=>Buffer.isBuffer(e),{message:"Expected Buffer"}),rn={buffer:()=>yr.brand(D),string:()=>Fe.z.string().brand(D),binary:()=>yr.or(Fe.z.string()).brand(D),base64:()=>Fe.z.string().base64().brand(D)};function rt(e){return rn[e||"string"]()}var gr=require("zod");var Y=Symbol("Raw"),hr=(e={})=>gr.z.object({raw:rt("buffer")}).extend(e).brand(Y);var xr=require("zod"),Se=Symbol("Upload"),br=()=>xr.z.custom(e=>typeof e=="object"&&e!==null&&"name"in e&&"encoding"in e&&"mimetype"in e&&"data"in e&&"tempFilePath"in e&&"truncated"in e&&"size"in e&&"md5"in e&&"mv"in e&&typeof e.name=="string"&&typeof e.encoding=="string"&&typeof e.mimetype=="string"&&Buffer.isBuffer(e.data)&&typeof e.tempFilePath=="string"&&typeof e.truncated=="boolean"&&typeof e.size=="number"&&typeof e.md5=="string"&&typeof e.mv=="function",e=>({message:`Expected file upload, received ${typeof e}`})).brand(Se);var Sr=(e,{next:t})=>e.options.some(t),on=({_def:e},{next:t})=>[e.left,e.right].some(t),ot=(e,{next:t})=>t(e.unwrap()),Zt={ZodObject:({shape:e},{next:t})=>Object.values(e).some(t),ZodUnion:Sr,ZodDiscriminatedUnion:Sr,ZodIntersection:on,ZodEffects:(e,{next:t})=>t(e.innerType()),ZodOptional:ot,ZodNullable:ot,ZodRecord:({valueSchema:e},{next:t})=>t(e),ZodArray:({element:e},{next:t})=>t(e),ZodDefault:({_def:e},{next:t})=>t(e.innerType)},nt=(e,{condition:t,rules:r=Zt,depth:o=1,maxDepth:n=Number.POSITIVE_INFINITY})=>{if(t?.(e))return!0;let i=o<n?r[e._def[h]?.brand]||r[e._def.typeName]:void 0;return i?i(e,{next:a=>nt(a,{condition:t,rules:r,maxDepth:n,depth:o+1})}):!1},Tr=e=>nt(e,{condition:t=>t._def[h]?.brand===Se}),Or=e=>nt(e,{condition:t=>t._def[h]?.brand===Y,maxDepth:3}),Et=(e,t)=>{let r=new WeakSet;return nt(e,{maxDepth:300,rules:{...Zt,ZodBranded:ot,ZodReadonly:ot,ZodCatch:({_def:{innerType:o}},{next:n})=>n(o),ZodPipeline:({_def:o},{next:n})=>n(o[t]),ZodLazy:(o,{next:n})=>r.has(o)?!1:r.add(o)&&n(o.schema),ZodTuple:({items:o,_def:{rest:n}},{next:i})=>[...o].concat(n??[]).some(i),ZodEffects:{out:void 0,in:Zt.ZodEffects}[t],ZodNaN:()=>(0,A.fail)("z.nan()"),ZodSymbol:()=>(0,A.fail)("z.symbol()"),ZodFunction:()=>(0,A.fail)("z.function()"),ZodMap:()=>(0,A.fail)("z.map()"),ZodSet:()=>(0,A.fail)("z.set()"),ZodBigInt:()=>(0,A.fail)("z.bigint()"),ZodVoid:()=>(0,A.fail)("z.void()"),ZodPromise:()=>(0,A.fail)("z.promise()"),ZodNever:()=>(0,A.fail)("z.never()"),ZodDate:()=>t==="in"&&(0,A.fail)("z.date()"),[ie]:()=>t==="in"&&(0,A.fail)("ez.dateOut()"),[se]:()=>t==="out"&&(0,A.fail)("ez.dateIn()"),[Y]:()=>t==="out"&&(0,A.fail)("ez.raw()"),[Se]:()=>t==="out"&&(0,A.fail)("ez.upload()"),[D]:()=>!1}})};var st=({error:e,logger:t,response:r})=>{t.error(`Result handler failure: ${e.message}.`),r.status(500).type("text/plain").end(`An error occurred while serving the result: ${e.message}.`+(e.originalError?`
Original error: ${e.originalError.message}.`:""))};var Rr=require("ramda");var ae=e=>oe(e)&&"or"in e,Oe=e=>oe(e)&&"and"in e,vt=e=>({and:(0,Rr.chain)(t=>Oe(t)?t.and:[t],e)}),it=(e,t)=>Oe(e)?{and:e.and.map(r=>ae(r)?{or:r.or.map(t)}:t(r))}:ae(e)?{or:e.or.map(r=>Oe(r)?{and:r.and.map(t)}:t(r))}:t(e),jt=e=>e.and.reduce((t,r)=>({or:re(t.or,ae(r)?r.or:[r],vt)}),{or:[]}),Te=(e,t)=>Oe(e)?ae(t)?Te(jt(e),t):vt([e,t]):ae(e)?Oe(t)?Te(t,e):ae(t)?{or:re(e.or,t.or,vt)}:Te(e,{and:[t]}):Oe(t)||ae(t)?Te(t,e):{and:[e,t]};var Nt=require("zod");var Lt=class{},$=class extends Lt{#e;#t;#r;constructor({input:t,security:r,handler:o}){super(),this.#e=t,this.#t=r,this.#r=o}getSecurity(){return this.#t}getSchema(){return this.#e}async execute({input:t,...r}){try{let o=await this.#e.parseAsync(t);return this.#r({...r,input:o})}catch(o){throw o instanceof Nt.z.ZodError?new H(o):o}}},Re=class extends ${constructor(t,{provider:r=()=>({}),transformer:o=n=>n}={}){super({input:Nt.z.object({}),handler:async({request:n,response:i})=>new Promise((a,p)=>{let d=c=>{if(c&&c instanceof Error)return p(o(c));a(r(n,i))};t(n,i,d)?.catch(d)})})}};var Be=class{},at=class extends Be{#e;#t;#r;#i;#o;#a;#p;#n;#c;#d;#l;#s;constructor({methods:t,inputSchema:r,outputSchema:o,handler:n,resultHandler:i,getOperationId:a=()=>{},scopes:p=[],middlewares:d=[],tags:c=[],description:u,shortDescription:m}){super(),this.#a=n,this.#p=i,this.#r=d,this.#l=a,this.#t=Object.freeze(t),this.#c=Object.freeze(p),this.#d=Object.freeze(c),this.#e={long:u,short:m},this.#n={input:r,output:o},this.#o={positive:Object.freeze(i.getPositiveResponse(o)),negative:Object.freeze(i.getNegativeResponse())},this.#s=Tr(r)?"upload":Or(r)?"raw":"json",this.#i={input:Object.freeze([C[this.#s]]),positive:Object.freeze(this.#o.positive.flatMap(({mimeTypes:f})=>f)),negative:Object.freeze(this.#o.negative.flatMap(({mimeTypes:f})=>f))}}getDescription(t){return this.#e[t]}getMethods(){return this.#t}getSchema(t){return t==="input"||t==="output"?this.#n[t]:this.getResponses(t).map(({schema:r})=>r).reduce((r,o)=>r.or(o))}getMimeTypes(t){return this.#i[t]}getRequestType(){return this.#s}getResponses(t){return this.#o[t]}getSecurity(){return this.#r.reduce((t,r)=>{let o=r.getSecurity();return o?Te(t,o):t},{and:[]})}getScopes(){return this.#c}getTags(){return this.#d}getOperationId(t){return this.#l(t)}#m(t){return{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":this.#t.concat(t).concat("options").join(", ").toUpperCase(),"Access-Control-Allow-Headers":"content-type"}}async#u(t){try{return await this.#n.output.parseAsync(t)}catch(r){throw r instanceof kt.z.ZodError?new G(r):r}}async#f({method:t,input:r,request:o,response:n,logger:i,options:a}){for(let p of this.#r)if(!(t==="options"&&!(p instanceof Re))&&(Object.assign(a,await p.execute({input:r,options:a,request:o,response:n,logger:i})),n.writableEnded)){i.warn("A middleware has closed the stream. Accumulated options:",a);break}}async#y({input:t,options:r,logger:o}){let n;try{n=await this.#n.input.parseAsync(t)}catch(i){throw i instanceof kt.z.ZodError?new H(i):i}return this.#a({input:n,options:r,logger:o})}async#g({error:t,request:r,response:o,logger:n,input:i,output:a,options:p}){try{await this.#p.execute({error:t,output:a,request:r,response:o,logger:n,input:i,options:p})}catch(d){st({logger:n,response:o,error:new _(xe(d).message,t||void 0)})}}async execute({request:t,response:r,logger:o,config:n,siblingMethods:i=[]}){let a=Ct(t),p={},d=null,c=null;if(n.cors){let m=this.#m(i);typeof n.cors=="function"&&(m=await n.cors({request:t,logger:o,endpoint:this,defaultHeaders:m}));for(let f in m)r.set(f,m[f])}let u=Je(t,n.inputSources);try{if(await this.#f({method:a,input:u,request:t,response:r,logger:o,options:p}),r.writableEnded)return;if(a==="options"){r.status(200).end();return}d=await this.#u(await this.#y({input:u,logger:o,options:p}))}catch(m){c=xe(m)}await this.#g({input:u,output:d,request:t,response:r,error:c,logger:o,options:p})}};var Ar=(e,t)=>{let r=e.map(n=>n.getSchema()).concat(t),o=r.reduce((n,i)=>n.and(i));return r.reduce((n,i)=>dr(i,n),o)};var U=require("zod");var pe={positive:200,negative:400};var Pr=R(require("node:assert/strict"),1),Cr=require("zod");var pt=(e,t)=>typeof e=="function"?pt(e(...t.arguments),t):e instanceof Cr.z.ZodType?[{...t,schema:e}]:(Array.isArray(e)&&(0,Pr.default)(e.length,new _(`At least one ${t.variant} response schema required.`)),(Array.isArray(e)?e:[e]).map(({schema:r,statusCodes:o,statusCode:n,mimeTypes:i,mimeType:a})=>({schema:r,statusCodes:n?[n]:o||t.statusCodes,mimeTypes:a?[a]:i||t.mimeTypes})));var Mt=class{#e;constructor(t){this.#e=t}execute(...t){return this.#e(...t)}},Ae=class extends Mt{#e;#t;constructor(t){super(t.handler),this.#e=t.positive,this.#t=t.negative}getPositiveResponse(t){return pt(this.#e,{variant:"positive",arguments:[t],statusCodes:[pe.positive],mimeTypes:[C.json]})}getNegativeResponse(){return pt(this.#t,{variant:"negative",arguments:[],statusCodes:[pe.negative],mimeTypes:[C.json]})}},Pe=new Ae({positive:e=>{let t=q({schema:e}),r=U.z.object({status:U.z.literal("success"),data:e});return t.reduce((o,n)=>o.example({status:"success",data:n}),r)},negative:U.z.object({status:U.z.literal("error"),error:U.z.object({message:U.z.string()})}).example({status:"error",error:{message:B(new Error("Sample error message"))}}),handler:({error:e,input:t,output:r,request:o,response:n,logger:i})=>{if(!e){n.status(pe.positive).json({status:"success",data:r});return}let a=De(e);wt({logger:i,statusCode:a,request:o,error:e,input:t}),n.status(a).json({status:"error",error:{message:B(e)}})}}),ct=new Ae({positive:e=>{let t=q({schema:e}),r="shape"in e&&"items"in e.shape&&e.shape.items instanceof U.z.ZodArray?e.shape.items:U.z.array(U.z.any());return t.reduce((o,n)=>oe(n)&&"items"in n&&Array.isArray(n.items)?o.example(n.items):o,r)},negative:U.z.string().example(B(new Error("Sample error message"))),handler:({response:e,output:t,error:r,logger:o,request:n,input:i})=>{if(r){let a=De(r);wt({logger:o,statusCode:a,request:n,error:r,input:i}),e.status(a).type("text/plain").send(r.message);return}t&&"items"in t&&Array.isArray(t.items)?e.status(pe.positive).json(t.items):e.status(500).type("text/plain").send("Property 'items' is missing in the endpoint output")}});var Ce=class e{resultHandler;middlewares=[];constructor(t){this.resultHandler="resultHandler"in t?t.resultHandler:t}static#e(t,r){let o=new e(r);return o.middlewares=t,o}addMiddleware(t){return e.#e(this.middlewares.concat(t instanceof $?t:new $(t)),this.resultHandler)}use=this.addExpressMiddleware;addExpressMiddleware(...t){return e.#e(this.middlewares.concat(new Re(...t)),this.resultHandler)}addOptions(t){return e.#e(this.middlewares.concat(new $({input:zr.z.object({}),handler:t})),this.resultHandler)}build({input:t,handler:r,output:o,description:n,shortDescription:i,operationId:a,...p}){let{middlewares:d,resultHandler:c}=this,u="methods"in p?p.methods:[p.method],m=typeof a=="function"?a:()=>a,f="scopes"in p?p.scopes:"scope"in p&&p.scope?[p.scope]:[],T="tags"in p?p.tags:"tag"in p&&p.tag?[p.tag]:[];return new at({handler:r,middlewares:d,outputSchema:o,resultHandler:c,scopes:f,tags:T,methods:u,getOperationId:m,description:n,shortDescription:i,inputSchema:Ar(d,t)})}},wr=new Ce(Pe),Ir=new Ce(ct);var j=require("ansis"),kr=require("node:util"),Ut=require("node:perf_hooks");var lt={debug:10,info:20,warn:30,error:40},Er=e=>oe(e)&&Object.keys(lt).some(t=>t in e),vr=e=>e in lt,jr=(e,t)=>lt[e]<lt[t],Lr=(e=0)=>Intl.NumberFormat(void 0,{useGrouping:!1,minimumFractionDigits:0,maximumFractionDigits:e}),dt=Lr(),Zr=Lr(2),nn=e=>e<1e-6?["picosecond",e/1e-9,dt]:e<.001?["nanosecond",e/1e-6,dt]:e<1?["microsecond",e/.001,dt]:e<1e3?["millisecond",e,dt]:e<6e4?["second",e/1e3,Zr]:["minute",e/6e4,Zr],Nr=e=>{let[t,r,o]=nn(e);return`${o.format(r)} ${t}${r>1?"s":""}`};var ze=class e{constructor(t){this.config=t;let{color:r=new j.Ansis().isSupported()}=t;this.hasColor=r}hasColor;styles={debug:j.blue,info:j.green,warn:(0,j.hex)("#FFA500"),error:j.red};prettyPrint(t){let{depth:r=2}=this.config;return(0,kr.inspect)(t,{depth:r,colors:this.hasColor,breakLength:this.config.level==="debug"?80:1/0,compact:this.config.level==="debug"?3:!0})}print(t,r,o){if(this.config.level==="silent"||jr(t,this.config.level))return;let{requestId:n,...i}=this.config.ctx||{},a=[new Date().toISOString()];n&&a.push(this.hasColor?(0,j.cyanBright)(n):n),a.push(this.hasColor?`${this.styles[t](t)}:`:`${t}:`,r),o!==void 0&&a.push(this.prettyPrint(o)),Object.keys(i).length>0&&a.push(this.prettyPrint(i)),console.log(a.join(" "))}debug(t,r){this.print("debug",t,r)}info(t,r){this.print("info",t,r)}warn(t,r){this.print("warn",t,r)}error(t,r){this.print("error",t,r)}child(t){return new e({...this.config,ctx:t})}profile(t){let r=Ut.performance.now();return()=>{let o=Ut.performance.now()-r,{message:n,severity:i="debug",formatter:a=Nr}=typeof t=="object"?t:{message:t};this.print(typeof i=="function"?i(o):i,n,a(o))}}};var Ie=require("ramda"),we=class{pairs;firstEndpoint;siblingMethods;constructor(t){this.pairs=Object.freeze((0,Ie.toPairs)(t).filter(r=>r!==void 0&&r[1]!==void 0)),this.firstEndpoint=(0,Ie.head)(this.pairs)?.[1],this.siblingMethods=Object.freeze((0,Ie.tail)(this.pairs).map(([r])=>r))}};var Mr=R(require("express"),1),Ze=class{params;constructor(...t){this.params=t}apply(t,r){return r(t,Mr.default.static(...this.params))}};var mt=R(require("express"),1),eo=R(require("node:http"),1),to=R(require("node:https"),1);var Ee=async(e,t="default")=>{try{return(await Promise.resolve().then(()=>R(require(e))))[t]}catch{}throw new he(e)};var Ht=R(require("node:assert/strict"),1);var ce=({routing:e,onEndpoint:t,onStatic:r,parentPath:o,hasCors:n})=>{let i=Object.entries(e).map(([a,p])=>[a.trim(),p]);for(let[a,p]of i){Ht.default.doesNotMatch(a,/\//,new te(`The entry '${a}' must avoid having slashes \u2014 use nesting instead.`));let d=`${o||""}${a?`/${a}`:""}`;if(p instanceof Be){let c=p.getMethods().slice();n&&c.push("options");for(let u of c)t(p,d,u)}else if(p instanceof Ze)r&&p.apply(d,r);else if(p instanceof we){for(let[c,u]of p.pairs)(0,Ht.default)(u.getMethods().includes(c),new te(`Endpoint assigned to ${c} method of ${d} must support ${c} method.`)),t(u,d,c);n&&p.firstEndpoint&&t(p.firstEndpoint,d,"options",p.siblingMethods)}else ce({onEndpoint:t,onStatic:r,hasCors:n,routing:p,parentPath:d})}};var Dt=({app:e,rootLogger:t,getChildLogger:r,config:o,routing:n,parsers:i})=>{let a=new WeakSet;ce({routing:n,hasCors:!!o.cors,onEndpoint:(p,d,c,u)=>{let m=p.getRequestType();if(!a.has(p)){if(m==="json")try{Et(p.getSchema("input"),"in")}catch(f){t.warn("The final input schema of the endpoint contains an unsupported JSON payload type.",{path:d,method:c,reason:f})}for(let f of["positive","negative"])if(p.getMimeTypes(f).includes(C.json))try{Et(p.getSchema("output"),"out")}catch(T){t.warn(`The final ${f} response schema of the endpoint contains an unsupported JSON payload type.`,{path:d,method:c,reason:T})}a.add(p)}e[c](d,...i?.[m]||[],async(f,T)=>p.execute({request:f,response:T,logger:r(f),config:o,siblingMethods:u}))},onStatic:(p,d)=>{e.use(p,d)}})};var qe=R(require("http-errors"),1);var Br=require("node:timers/promises");var Ur=e=>"_httpMessage"in e&&typeof e._httpMessage=="object"&&e._httpMessage!==null&&"headersSent"in e._httpMessage&&typeof e._httpMessage.headersSent=="boolean"&&"setHeader"in e._httpMessage&&typeof e._httpMessage.setHeader=="function",Hr=e=>"server"in e&&typeof e.server=="object"&&e.server!==null&&"close"in e.server&&typeof e.server.close=="function",Dr=e=>"encrypted"in e&&typeof e.encrypted=="boolean"&&e.encrypted,Kr=({},e)=>void(!e.headersSent&&e.setHeader("connection","close")),Fr=e=>new Promise((t,r)=>void e.close(o=>o?r(o):t()));var qr=(e,{timeout:t=1e3,logger:r}={})=>{let o,n=new Set,i=c=>void n.delete(c.destroy()),a=c=>void(Ur(c)?!c._httpMessage.headersSent&&c._httpMessage.setHeader("connection","close"):i(c)),p=c=>void(o?c.destroy():n.add(c.once("close",()=>void n.delete(c))));for(let c of e)for(let u of["connection","secureConnection"])c.on(u,p);let d=async()=>{for(let c of e)c.on("request",Kr);r?.info("Graceful shutdown",{sockets:n.size,timeout:t});for(let c of n)(Dr(c)||Hr(c))&&a(c);for await(let c of(0,Br.setInterval)(10,Date.now()))if(n.size===0||Date.now()-c>=t)break;for(let c of n)i(c);return Promise.allSettled(e.map(Fr))};return{sockets:n,shutdown:()=>o??=d()}};var $r=({errorHandler:e,getChildLogger:t})=>async(r,o,n,i)=>r?e.execute({error:(0,qe.isHttpError)(r)?r:(0,qe.default)(400,xe(r).message),request:o,response:n,input:null,output:null,options:{},logger:t(o)}):i(),Vr=({errorHandler:e,getChildLogger:t})=>async(r,o)=>{let n=(0,qe.default)(404,`Can not ${r.method} ${r.path}`),i=t(r);try{e.execute({request:r,response:o,logger:i,error:n,input:null,output:null,options:{}})}catch(a){st({response:o,logger:i,error:new _(xe(a).message,n)})}},sn=e=>(t,{},r)=>{if(Object.values(t?.files||[]).flat().find(({truncated:n})=>n))return r(e);r()},an=e=>({log:e.debug.bind(e)}),Gr=async({getChildLogger:e,config:t})=>{let r=await Ee("express-fileupload"),{limitError:o,beforeUpload:n,...i}={...typeof t.server.upload=="object"&&t.server.upload},a=[];return a.push(async(p,d,c)=>{let u=e(p);try{await n?.({request:p,logger:u})}catch(m){return c(m)}return r({debug:!0,...i,abortOnLimit:!1,parseNested:!0,logger:an(u)})(p,d,c)}),o&&a.push(sn(o)),a},_r=(e,{},t)=>{Buffer.isBuffer(e.body)&&(e.body={raw:e.body}),t()},Yr=({rootLogger:e,config:t})=>async(r,o,n)=>{let i=t.childLoggerProvider?await t.childLoggerProvider({request:r,parent:e}):e;i.debug(`${r.method}: ${r.path}`),r.res&&(r.res.locals[h]={logger:i}),n()},Qr=e=>t=>t.res?.locals[h]?.logger||e,Jr=e=>process.on("deprecation",({message:t,namespace:r,name:o,stack:n})=>e.warn(`${o} (${r}): ${t}`,n.split(`
`).slice(1))),Wr=({servers:e,logger:t,options:{timeout:r,events:o=["SIGINT","SIGTERM"]}})=>{let n=qr(e,{logger:t,timeout:r}),i=()=>n.shutdown().then(()=>process.exit());for(let a of o)process.on(a,i)};var L=require("ansis"),Xr=()=>{let e=(0,L.italic)("Proudly supports transgender community.".padStart(109)),t=(0,L.italic)("Start your API server with I/O schema validation and custom middlewares in minutes.".padStart(109)),r=(0,L.italic)("Thank you for choosing Express Zod API for your project.".padStart(132)),o=(0,L.italic)("for Zoey".padEnd(20)),n=(0,L.hex)("#F5A9B8"),i=(0,L.hex)("#5BCEFA"),a=new Array(14).fill(i,1,3).fill(n,3,5).fill(L.whiteBright,5,7).fill(n,7,9).fill(i,9,12).fill(L.gray,12,13);return`
8888888888                                                          8888888888P              888             d8888 8888888b. 8888888
888                                                                       d88P               888            d88888 888   Y88b  888
888                                                                      d88P                888           d88P888 888    888  888
8888888    888  888 88888b.  888d888 .d88b.  .d8888b  .d8888b           d88P    .d88b.   .d88888          d88P 888 888   d88P  888
888        \u1FEFY8bd8P' 888 "88b 888P"  d8P  Y8b 88K      88K              d88P    d88""88b d88" 888         d88P  888 8888888P"   888
888          X88K   888  888 888    88888888 "Y8888b. "Y8888b.        d88P     888  888 888  888        d88P   888 888         888
888        .d8""8b. 888 d88P 888    Y8b.          X88      X88       d88P      Y88..88P Y88b 888       d8888888888 888         888
8888888888 888  888 88888P"  888     "Y8888   88888P'  88888P'      d8888888888 "Y88P"   "Y88888      d88P     888 888       8888888
                    888
                    888${e}
${o}888${t}
${r}
`.split(`
`).map((d,c)=>a[c]?a[c](d):d).join(`
`)};var ro=e=>{e.startupLogo!==!1&&console.log(Xr());let t=e.errorHandler||Pe,r=Er(e.logger)?e.logger:new ze(e.logger);r.debug("Running","v20.15.2 (CJS)"),Jr(r);let o=Yr({rootLogger:r,config:e}),i={getChildLogger:Qr(r),errorHandler:t},a=Vr(i),p=$r(i);return{...i,rootLogger:r,notFoundHandler:a,parserFailureHandler:p,loggingMiddleware:o}},oo=(e,t)=>{let{rootLogger:r,getChildLogger:o,notFoundHandler:n,loggingMiddleware:i}=ro(e);return Dt({app:e.app.use(i),rootLogger:r,routing:t,getChildLogger:o,config:e}),{notFoundHandler:n,logger:r}},no=async(e,t)=>{let{rootLogger:r,getChildLogger:o,notFoundHandler:n,parserFailureHandler:i,loggingMiddleware:a}=ro(e),p=(0,mt.default)().disable("x-powered-by").use(a);if(e.server.compression){let f=await Ee("compression");p.use(f(typeof e.server.compression=="object"?e.server.compression:void 0))}let d={json:[e.server.jsonParser||mt.default.json()],raw:[e.server.rawParser||mt.default.raw(),_r],upload:e.server.upload?await Gr({config:e,getChildLogger:o}):[]};e.server.beforeRouting&&await e.server.beforeRouting({app:p,logger:r,getChildLogger:o}),Dt({app:p,routing:t,rootLogger:r,getChildLogger:o,config:e,parsers:d}),p.use(i,n);let c=(f,T)=>f.listen(T,()=>r.info("Listening",T)),u=eo.default.createServer(p),m=e.https&&to.default.createServer(e.https.options,p);return e.gracefulShutdown&&Wr({servers:[u].concat(m||[]),logger:r,options:e.gracefulShutdown===!0?{}:e.gracefulShutdown}),{app:p,logger:r,httpServer:c(u,e.server.listen),httpsServer:m&&c(m,e.https?.listen)}};var To=R(require("node:assert/strict"),1),Oo=require("openapi3-ts/oas31"),gt=require("ramda");var Q=R(require("node:assert/strict"),1),V=require("openapi3-ts/oas31"),l=require("ramda"),b=require("zod");var de=(e,{onEach:t,rules:r,onMissing:o,ctx:n={}})=>{let i=r[e._def[h]?.brand]||r[e._def.typeName],p=i?i(e,{...n,next:c=>de(c,{ctx:n,onEach:t,rules:r,onMissing:o})}):o(e,n),d=t&&t(e,{prev:p,...n});return d?{...p,...d}:p};var so=50,ao="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/toISOString",pn={integer:0,number:0,string:"",boolean:!1,object:{},null:null,array:[]},po=/:([A-Za-z0-9_]+)/g,cn=e=>e.match(po)?.map(t=>t.slice(1))||[],co=e=>e.replace(po,t=>`{${t.slice(1)}}`),dn=({_def:e},{next:t})=>({...t(e.innerType),default:e[h]?.defaultLabel||e.defaultValue()}),ln=({_def:{innerType:e}},{next:t})=>t(e),mn=()=>({format:"any"}),un=({},e)=>((0,Q.default)(!e.isResponse,new v({message:"Please use ez.upload() only for input.",...e})),{type:"string",format:"binary"}),fn=e=>{let t=e.unwrap();return{type:"string",format:t instanceof b.z.ZodString?t._def.checks.find(r=>r.kind==="base64")?"byte":"file":"binary"}},yn=({options:e},{next:t})=>({oneOf:e.map(t)}),gn=({options:e,discriminator:t},{next:r})=>({discriminator:{propertyName:t},oneOf:e.map(r)}),hn=e=>{let[t,r]=e.filter(V.isSchemaObject).filter(n=>n.type==="object"&&Object.keys(n).every(i=>["type","properties","required","examples"].includes(i)));(0,Q.default)(t&&r,"Can not flatten objects");let o={type:"object"};return(t.properties||r.properties)&&(o.properties=(0,l.mergeDeepWith)((n,i)=>Array.isArray(n)&&Array.isArray(i)?(0,l.concat)(n,i):n===i?i:Q.default.fail("Can not flatten properties"),t.properties||{},r.properties||{})),(t.required||r.required)&&(o.required=(0,l.union)(t.required||[],r.required||[])),(t.examples||r.examples)&&(o.examples=re(t.examples||[],r.examples||[],([n,i])=>(0,l.mergeDeepRight)(n,i))),o},xn=({_def:{left:e,right:t}},{next:r})=>{let o=[e,t].map(r);try{return hn(o)}catch{}return{allOf:o}},bn=(e,{next:t})=>t(e.unwrap()),Sn=(e,{next:t})=>t(e.unwrap()),Tn=(e,{next:t})=>{let r=t(e.unwrap());return(0,V.isSchemaObject)(r)&&(r.type=mo(r)),r},lo=e=>{let t=(0,l.toLower)((0,l.type)(e));return typeof e=="bigint"?"integer":t==="number"||t==="string"||t==="boolean"||t==="object"||t==="null"||t==="array"?t:void 0},io=e=>({type:lo(Object.values(e.enum)[0]),enum:Object.values(e.enum)}),On=({value:e})=>({type:lo(e),const:e}),Rn=(e,{isResponse:t,next:r})=>{let o=Object.keys(e.shape),n=p=>t&&Ke(p)?p instanceof b.z.ZodOptional:p.isOptional(),i=o.filter(p=>!n(e.shape[p])),a={type:"object"};return o.length&&(a.properties=ut(e,r)),i.length&&(a.required=i),a},An=()=>({type:"null"}),Pn=({},e)=>((0,Q.default)(!e.isResponse,new v({message:"Please use ez.dateOut() for output.",...e})),{description:"YYYY-MM-DDTHH:mm:ss.sssZ",type:"string",format:"date-time",pattern:/^\d{4}-\d{2}-\d{2}(T\d{2}:\d{2}:\d{2}(\.\d+)?)?Z?$/.source,externalDocs:{url:ao}}),Cn=({},e)=>((0,Q.default)(e.isResponse,new v({message:"Please use ez.dateIn() for input.",...e})),{description:"YYYY-MM-DDTHH:mm:ss.sssZ",type:"string",format:"date-time",externalDocs:{url:ao}}),zn=({},e)=>Q.default.fail(new v({message:`Using z.date() within ${e.isResponse?"output":"input"} schema is forbidden. Please use ez.date${e.isResponse?"Out":"In"}() instead. Check out the documentation for details.`,...e})),wn=()=>({type:"boolean"}),In=()=>({type:"integer",format:"bigint"}),Zn=e=>e.every(t=>t instanceof b.z.ZodLiteral),En=({keySchema:e,valueSchema:t},{next:r})=>{if(e instanceof b.z.ZodEnum||e instanceof b.z.ZodNativeEnum){let o=Object.values(e.enum),n={type:"object"};return o.length&&(n.properties=ut(b.z.object((0,l.fromPairs)((0,l.xprod)(o,[t]))),r),n.required=o),n}if(e instanceof b.z.ZodLiteral)return{type:"object",properties:ut(b.z.object({[e.value]:t}),r),required:[e.value]};if(e instanceof b.z.ZodUnion&&Zn(e.options)){let o=(0,l.map)(i=>`${i.value}`,e.options),n=(0,l.fromPairs)((0,l.xprod)(o,[t]));return{type:"object",properties:ut(b.z.object(n),r),required:o}}return{type:"object",additionalProperties:r(t)}},vn=({_def:{minLength:e,maxLength:t},element:r},{next:o})=>{let n={type:"array",items:o(r)};return e&&(n.minItems=e.value),t&&(n.maxItems=t.value),n},jn=({items:e,_def:{rest:t}},{next:r})=>({type:"array",prefixItems:e.map(r),items:t===null?{not:{}}:r(t)}),Ln=({isEmail:e,isURL:t,minLength:r,maxLength:o,isUUID:n,isCUID:i,isCUID2:a,isULID:p,isIP:d,isEmoji:c,isDatetime:u,_def:{checks:m}})=>{let f=m.find(P=>P.kind==="regex"),T=m.find(P=>P.kind==="datetime"),O=f?f.regex:T?T.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?(([+-]\\d{2}:\\d{2})|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?Z$"):void 0,Z={type:"string"},x={"date-time":u,email:e,url:t,uuid:n,cuid:i,cuid2:a,ulid:p,ip:d,emoji:c};for(let P in x)if(x[P]){Z.format=P;break}return r!==null&&(Z.minLength=r),o!==null&&(Z.maxLength=o),O&&(Z.pattern=O.source),Z},Nn=({isInt:e,maxValue:t,minValue:r,_def:{checks:o}})=>{let n=o.find(m=>m.kind==="min"),i=r===null?e?Number.MIN_SAFE_INTEGER:-Number.MAX_VALUE:r,a=n?n.inclusive:!0,p=o.find(m=>m.kind==="max"),d=t===null?e?Number.MAX_SAFE_INTEGER:Number.MAX_VALUE:t,c=p?p.inclusive:!0,u={type:e?"integer":"number",format:e?"int64":"double"};return a?u.minimum=i:u.exclusiveMinimum=i,c?u.maximum=d:u.exclusiveMaximum=d,u},ut=({shape:e},t)=>(0,l.map)(t,e),kn=e=>{let t=Array.isArray(e.type)?e.type[0]:e.type;return pn?.[t]},mo=e=>{let t=typeof e.type=="string"?[e.type]:e.type||[];return t.includes("null")?t:t.concat("null")},Mn=(e,{isResponse:t,next:r})=>{let o=r(e.innerType()),{effect:n}=e._def;if(t&&n.type==="transform"&&(0,V.isSchemaObject)(o)){let i=We(e,kn(o));return i&&["number","string","boolean"].includes(i)?{type:i}:r(b.z.any())}if(!t&&n.type==="preprocess"&&(0,V.isSchemaObject)(o)){let{type:i,...a}=o;return{...a,format:`${a.format||i} (preprocessed)`}}return o},Un=({_def:e},{isResponse:t,next:r})=>r(e[t?"out":"in"]),Hn=(e,{next:t})=>t(e.unwrap()),Dn=(e,{next:t,makeRef:r})=>r(e,()=>t(e.schema)),Kn=(e,{next:t})=>t(e.unwrap().shape.raw),uo=e=>e.length?(0,l.fromPairs)((0,l.zip)((0,l.range)(1,e.length+1).map(t=>`example${t}`),(0,l.map)((0,l.objOf)("value"),e))):void 0,fo=(e,t,r=[])=>(0,l.pipe)(q,(0,l.map)((0,l.when)(o=>(0,l.type)(o)==="Object",(0,l.omit)(r))),uo)({schema:e,variant:t?"parsed":"original",validate:!0}),Fn=(e,t)=>(0,l.pipe)(q,(0,l.filter)((0,l.has)(t)),(0,l.pluck)(t),uo)({schema:e,variant:"original",validate:!0}),le=e=>e instanceof b.z.ZodObject?e:e instanceof b.z.ZodBranded?le(e.unwrap()):e instanceof b.z.ZodUnion||e instanceof b.z.ZodDiscriminatedUnion?e.options.map(t=>le(t)).reduce((t,r)=>t.merge(r.partial()),b.z.object({})):e instanceof b.z.ZodEffects?le(e._def.schema):e instanceof b.z.ZodPipeline?le(e._def.in):le(e._def.left).merge(le(e._def.right)),yo=({path:e,method:t,schema:r,inputSources:o,makeRef:n,composition:i,brandHandling:a,description:p=`${t.toUpperCase()} ${e} Parameter`})=>{let{shape:d}=le(r),c=cn(e),u=o.includes("query"),m=o.includes("params"),f=o.includes("headers"),T=x=>m&&c.includes(x),O=x=>f&&zt(x);return Object.keys(d).map(x=>({name:x,location:T(x)?"path":O(x)?"header":u?"query":void 0})).filter(x=>x.location!==void 0).map(({name:x,location:P})=>{let X=de(d[x],{rules:{...a,...Ft},onEach:Bt,onMissing:qt,ctx:{isResponse:!1,makeRef:n,path:e,method:t}}),fe=i==="components"?n(d[x],X,M(p,x)):X;return{name:x,in:P,required:!d[x].isOptional(),description:X.description||p,schema:fe,examples:Fn(r,x)}})},Ft={ZodString:Ln,ZodNumber:Nn,ZodBigInt:In,ZodBoolean:wn,ZodNull:An,ZodArray:vn,ZodTuple:jn,ZodRecord:En,ZodObject:Rn,ZodLiteral:On,ZodIntersection:xn,ZodUnion:yn,ZodAny:mn,ZodDefault:dn,ZodEnum:io,ZodNativeEnum:io,ZodEffects:Mn,ZodOptional:bn,ZodNullable:Tn,ZodDiscriminatedUnion:gn,ZodBranded:Hn,ZodDate:zn,ZodCatch:ln,ZodPipeline:Un,ZodLazy:Dn,ZodReadonly:Sn,[D]:fn,[Se]:un,[ie]:Cn,[se]:Pn,[Y]:Kn},Bt=(e,{isResponse:t,prev:r})=>{if((0,V.isReferenceObject)(r))return{};let{description:o}=e,n=e instanceof b.z.ZodLazy,i=r.type!==void 0,a=t&&Ke(e),p=!n&&i&&!a&&e.isNullable(),d=n?[]:q({schema:e,variant:t?"parsed":"original",validate:!0}),c={};return o&&(c.description=o),p&&(c.type=mo(r)),d.length&&(c.examples=d.slice()),c},qt=(e,t)=>Q.default.fail(new v({message:`Zod type ${e.constructor.name} is unsupported.`,...t})),Kt=(e,t)=>{if((0,V.isReferenceObject)(e))return e;let r={...e};return r.properties&&(r.properties=(0,l.omit)(t,r.properties)),r.examples&&(r.examples=r.examples.map(o=>(0,l.omit)(t,o))),r.required&&(r.required=r.required.filter(o=>!t.includes(o))),r.allOf&&(r.allOf=r.allOf.map(o=>Kt(o,t))),r.oneOf&&(r.oneOf=r.oneOf.map(o=>Kt(o,t))),r},go=e=>(0,V.isReferenceObject)(e)?e:(0,l.omit)(["examples"],e),ho=({method:e,path:t,schema:r,mimeTypes:o,variant:n,makeRef:i,composition:a,hasMultipleStatusCodes:p,statusCode:d,brandHandling:c,description:u=`${e.toUpperCase()} ${t} ${It(n)} response ${p?d:""}`.trim()})=>{let m=go(de(r,{rules:{...c,...Ft},onEach:Bt,onMissing:qt,ctx:{isResponse:!0,makeRef:i,path:t,method:e}})),f={schema:a==="components"?i(r,m,M(u)):m,examples:fo(r,!0)};return{description:u,content:(0,l.fromPairs)((0,l.xprod)(o,[f]))}},Bn=()=>({type:"http",scheme:"basic"}),qn=({format:e})=>{let t={type:"http",scheme:"bearer"};return e&&(t.bearerFormat=e),t},$n=({name:e},t)=>{let r={type:"apiKey",in:"query",name:e};return t?.includes("body")&&(t?.includes("query")?(r["x-in-alternative"]="body",r.description=`${e} CAN also be supplied within the request body`):(r["x-in-actual"]="body",r.description=`${e} MUST be supplied within the request body instead of query`)),r},Vn=({name:e})=>({type:"apiKey",in:"header",name:e}),Gn=({name:e})=>({type:"apiKey",in:"cookie",name:e}),_n=({url:e})=>({type:"openIdConnect",openIdConnectUrl:e}),Yn=({flows:e={}})=>({type:"oauth2",flows:(0,l.map)(t=>({...t,scopes:t.scopes||{}}),(0,l.reject)(l.isNil,e))}),xo=(e,t)=>{let r={basic:Bn,bearer:qn,input:$n,header:Vn,cookie:Gn,openid:_n,oauth2:Yn};return it(e,o=>r[o.type](o,t))},ft=e=>"or"in e?e.or.map(t=>"and"in t?(0,l.mergeAll)((0,l.map)(({name:r,scopes:o})=>(0,l.objOf)(r,o),t.and)):{[t.name]:t.scopes}):"and"in e?ft(jt(e)):ft({or:[e]}),bo=({method:e,path:t,schema:r,mimeTypes:o,makeRef:n,composition:i,brandHandling:a,paramNames:p,description:d=`${e.toUpperCase()} ${t} Request body`})=>{let c=go(Kt(de(r,{rules:{...a,...Ft},onEach:Bt,onMissing:qt,ctx:{isResponse:!1,makeRef:n,path:t,method:e}}),p)),u={schema:i==="components"?n(r,c,M(d)):c,examples:fo(r,!1,p)};return{description:d,content:(0,l.fromPairs)((0,l.xprod)(o,[u]))}},So=e=>Object.keys(e).map(t=>{let r=e[t],o={name:t,description:typeof r=="string"?r:r.description};return typeof r=="object"&&r.url&&(o.externalDocs={url:r.url}),o}),$t=e=>e.length<=so?e:e.slice(0,so-1)+"\u2026";var yt=class extends Oo.OpenApiBuilder{lastSecuritySchemaIds=new Map;lastOperationIdSuffixes=new Map;responseVariants=(0,gt.keys)(pe);references=new Map;makeRef(t,r,o=this.references.get(t)){return o||(o=`Schema${this.references.size+1}`,this.references.set(t,o),typeof r=="function"&&(r=r())),typeof r=="object"&&this.addSchema(o,r),{$ref:`#/components/schemas/${o}`}}ensureUniqOperationId(t,r,o){let n=o||M(r,t),i=this.lastOperationIdSuffixes.get(n);return i===void 0?(this.lastOperationIdSuffixes.set(n,1),n):(o&&To.default.fail(new v({message:`Duplicated operationId: "${o}"`,method:r,isResponse:!1,path:t})),i++,this.lastOperationIdSuffixes.set(n,i),`${n}${i}`)}ensureUniqSecuritySchemaName(t){let r=JSON.stringify(t);for(let n in this.rootDoc.components?.securitySchemes||{})if(r===JSON.stringify(this.rootDoc.components?.securitySchemes?.[n]))return n;let o=(this.lastSecuritySchemaIds.get(t.type)||0)+1;return this.lastSecuritySchemaIds.set(t.type,o),`${t.type.toUpperCase()}_${o}`}constructor({routing:t,config:r,title:o,version:n,serverUrl:i,descriptions:a,brandHandling:p,hasSummaryFromDescription:d=!0,composition:c="inline"}){super(),this.addInfo({title:o,version:n});for(let m of typeof i=="string"?[i]:i)this.addServer({url:m});ce({routing:t,onEndpoint:(m,f,T)=>{let O=T,Z={path:f,method:O,endpoint:m,composition:c,brandHandling:p,makeRef:this.makeRef.bind(this)},[x,P]=["short","long"].map(m.getDescription.bind(m)),X=x?$t(x):d&&P?$t(P):void 0,fe=m.getTags(),Le=r.inputSources?.[O]||Pt[O],ye=this.ensureUniqOperationId(f,O,m.getOperationId(O)),Ne=yo({...Z,inputSources:Le,schema:m.getSchema("input"),description:a?.requestParameter?.call(null,{method:O,path:f,operationId:ye})}),Ve={};for(let F of this.responseVariants){let ee=m.getResponses(F);for(let{mimeTypes:ke,schema:z,statusCodes:w}of ee)for(let E of w)Ve[E]=ho({...Z,variant:F,schema:z,mimeTypes:ke,statusCode:E,hasMultipleStatusCodes:ee.length>1||w.length>1,description:a?.[`${F}Response`]?.call(null,{method:O,path:f,operationId:ye,statusCode:E})})}let At=Le.includes("body")?bo({...Z,paramNames:(0,gt.pluck)("name",Ne),schema:m.getSchema("input"),mimeTypes:m.getMimeTypes("input"),description:a?.requestBody?.call(null,{method:O,path:f,operationId:ye})}):void 0,Ge=ft(it(xo(m.getSecurity(),Le),F=>{let ee=this.ensureUniqSecuritySchemaName(F),ke=["oauth2","openIdConnect"].includes(F.type)?m.getScopes().slice():[];return this.addSecurityScheme(ee,F),{name:ee,scopes:ke}}));this.addPath(co(f),{[O]:{operationId:ye,summary:X,description:P,tags:fe.length>0?fe:void 0,parameters:Ne.length>0?Ne:void 0,requestBody:At,security:Ge.length>0?Ge:void 0,responses:Ve}})}}),this.rootDoc.tags=r.tags?So(r.tags):[]}};var ht=require("node-mocks-http"),Qn=e=>(0,ht.createRequest)({...e,headers:{"content-type":C.json,...e?.headers}}),Jn=e=>(0,ht.createResponse)(e),Wn=e=>{let t={warn:[],error:[],info:[],debug:[]};return new Proxy(e||{},{get(r,o,n){return o==="_getLogs"?()=>t:vr(o)?(...i)=>t[o].push(i):Reflect.get(r,o,n)}})},Ro=({requestProps:e,responseOptions:t,configProps:r,loggerProps:o})=>{let n=Qn(e),i=Jn({req:n,...t});i.req=t?.req||n,n.res=i;let a=Wn(o),p={cors:!1,logger:a,...r};return{requestMock:n,responseMock:i,loggerMock:a,configMock:p}},Ao=async({endpoint:e,...t})=>{let{requestMock:r,responseMock:o,loggerMock:n,configMock:i}=Ro(t);return await e.execute({request:r,response:o,config:i,logger:n}),{requestMock:r,responseMock:o,loggerMock:n}},Po=async({middleware:e,options:t={},...r})=>{let{requestMock:o,responseMock:n,loggerMock:i,configMock:a}=Ro(r),p=Je(o,a.inputSources),d=await e.execute({request:o,response:n,logger:i,input:p,options:t});return{requestMock:o,responseMock:n,loggerMock:i,output:d}};var N=R(require("typescript"),1);var K=R(require("typescript"),1),ve=require("ramda"),s=K.default.factory,J=[s.createModifier(K.default.SyntaxKind.ExportKeyword)],Xn=[s.createModifier(K.default.SyntaxKind.AsyncKeyword)],es=[s.createModifier(K.default.SyntaxKind.PublicKeyword),s.createModifier(K.default.SyntaxKind.ReadonlyKeyword)],Co=[s.createModifier(K.default.SyntaxKind.ProtectedKeyword),s.createModifier(K.default.SyntaxKind.ReadonlyKeyword)],Vt=s.createTemplateHead(""),je=s.createTemplateTail(""),Gt=s.createTemplateMiddle(" "),_t=e=>s.createTemplateLiteralType(Vt,e.map((t,r)=>s.createTemplateLiteralTypeSpan(s.createTypeReferenceNode(t),r===e.length-1?je:Gt))),Yt=_t(["M","P"]),xt=(e,t,r)=>s.createParameterDeclaration(r,void 0,e,void 0,t,void 0),bt=(e,t)=>(0,ve.chain)(([r,o])=>[xt(s.createIdentifier(r),o,t)],(0,ve.toPairs)(e)),Qt=(e,t)=>s.createExpressionWithTypeArguments(s.createIdentifier("Record"),[typeof e=="number"?s.createKeywordTypeNode(e):s.createTypeReferenceNode(e),s.createKeywordTypeNode(t)]),zo=e=>s.createConstructorDeclaration(void 0,e,s.createBlock([])),wo=(e,t)=>s.createPropertySignature(void 0,e,void 0,s.createTypeReferenceNode(t)),W=(e,t,r)=>s.createVariableDeclarationList([s.createVariableDeclaration(e,void 0,r,t)],K.default.NodeFlags.Const),Jt=(e,t)=>s.createTypeAliasDeclaration(J,e,void 0,s.createUnionTypeNode(t.map(r=>s.createLiteralTypeNode(s.createStringLiteral(r))))),St=(e,t)=>s.createTypeAliasDeclaration(J,e,void 0,t),Io=(e,t,r)=>s.createPropertyDeclaration(es,e,void 0,t,r),Zo=(e,t,r)=>s.createClassDeclaration(J,e,void 0,void 0,[t,...r]),Eo=(e,t)=>s.createTypeReferenceNode("Promise",[s.createIndexedAccessTypeNode(s.createTypeReferenceNode(e),t)]),vo=()=>s.createTypeReferenceNode("Promise",[s.createKeywordTypeNode(K.default.SyntaxKind.AnyKeyword)]),jo=(e,t,r)=>s.createInterfaceDeclaration(J,e,void 0,t,r),ts=(0,ve.chain)(([e,t])=>[s.createTypeParameterDeclaration([],e,s.createTypeReferenceNode(t))]),Lo=e=>ts((0,ve.toPairs)(e)),Wt=(e,t,r)=>s.createArrowFunction(r?Xn:void 0,void 0,e.map(o=>xt(o)),void 0,void 0,t),Xt=(e,t,r)=>s.createCallExpression(s.createPropertyAccessExpression(s.createCallExpression(s.createPropertyAccessExpression(s.createIdentifier("Object"),"keys"),void 0,[e]),"reduce"),void 0,[s.createArrowFunction(void 0,void 0,bt({acc:void 0,key:void 0}),void 0,void 0,t),r]),No=(...e)=>`"${e.join(" ")}"`;var ko=["get","post","put","delete","patch"];var g=R(require("typescript"),1),Ot=require("zod");var S=R(require("typescript"),1),{factory:Tt}=S.default,er=(e,t)=>{S.default.addSyntheticLeadingComment(e,S.default.SyntaxKind.MultiLineCommentTrivia,`* ${t} `,!0)},me=(e,t,r)=>{let o=Tt.createTypeAliasDeclaration(void 0,Tt.createIdentifier(t),void 0,e);return r&&er(o,r),o},tr=(e,t)=>{let r=S.default.createSourceFile("print.ts","",S.default.ScriptTarget.Latest,!1,S.default.ScriptKind.TS);return S.default.createPrinter(t).printNode(S.default.EmitHint.Unspecified,e,r)},rs=/^[A-Za-z_$][A-Za-z0-9_$]*$/,Mo=e=>rs.test(e)?Tt.createIdentifier(e):Tt.createStringLiteral(e),os=[S.default.SyntaxKind.AnyKeyword,S.default.SyntaxKind.BigIntKeyword,S.default.SyntaxKind.BooleanKeyword,S.default.SyntaxKind.NeverKeyword,S.default.SyntaxKind.NumberKeyword,S.default.SyntaxKind.ObjectKeyword,S.default.SyntaxKind.StringKeyword,S.default.SyntaxKind.SymbolKeyword,S.default.SyntaxKind.UndefinedKeyword,S.default.SyntaxKind.UnknownKeyword,S.default.SyntaxKind.VoidKeyword],Uo=e=>os.includes(e.kind);var{factory:y}=g.default,ns={[g.default.SyntaxKind.AnyKeyword]:"",[g.default.SyntaxKind.BigIntKeyword]:BigInt(0),[g.default.SyntaxKind.BooleanKeyword]:!1,[g.default.SyntaxKind.NumberKeyword]:0,[g.default.SyntaxKind.ObjectKeyword]:{},[g.default.SyntaxKind.StringKeyword]:"",[g.default.SyntaxKind.UndefinedKeyword]:void 0},ss=({value:e})=>y.createLiteralTypeNode(typeof e=="number"?y.createNumericLiteral(e):typeof e=="boolean"?e?y.createTrue():y.createFalse():y.createStringLiteral(e)),is=({shape:e},{isResponse:t,next:r,optionalPropStyle:{withQuestionMark:o}})=>{let n=Object.entries(e).map(([i,a])=>{let p=t&&Ke(a)?a instanceof Ot.z.ZodOptional:a.isOptional(),d=y.createPropertySignature(void 0,Mo(i),p&&o?y.createToken(g.default.SyntaxKind.QuestionToken):void 0,r(a));return a.description&&er(d,a.description),d});return y.createTypeLiteralNode(n)},as=({element:e},{next:t})=>y.createArrayTypeNode(t(e)),ps=({options:e})=>y.createUnionTypeNode(e.map(t=>y.createLiteralTypeNode(y.createStringLiteral(t)))),Ho=({options:e},{next:t})=>{let r=new Map;for(let o of e){let n=t(o);r.set(Uo(n)?n.kind:n,n)}return y.createUnionTypeNode(Array.from(r.values()))},cs=e=>ns?.[e.kind],ds=(e,{next:t,isResponse:r})=>{let o=t(e.innerType());if(r&&e._def.effect.type==="transform"){let n=We(e,cs(o)),i={number:g.default.SyntaxKind.NumberKeyword,bigint:g.default.SyntaxKind.BigIntKeyword,boolean:g.default.SyntaxKind.BooleanKeyword,string:g.default.SyntaxKind.StringKeyword,undefined:g.default.SyntaxKind.UndefinedKeyword,object:g.default.SyntaxKind.ObjectKeyword};return y.createKeywordTypeNode(n&&i[n]||g.default.SyntaxKind.AnyKeyword)}return o},ls=e=>y.createUnionTypeNode(Object.values(e.enum).map(t=>y.createLiteralTypeNode(typeof t=="number"?y.createNumericLiteral(t):y.createStringLiteral(t)))),ms=(e,{next:t,optionalPropStyle:{withUndefined:r}})=>{let o=t(e.unwrap());return r?y.createUnionTypeNode([o,y.createKeywordTypeNode(g.default.SyntaxKind.UndefinedKeyword)]):o},us=(e,{next:t})=>y.createUnionTypeNode([t(e.unwrap()),y.createLiteralTypeNode(y.createNull())]),fs=({items:e,_def:{rest:t}},{next:r})=>y.createTupleTypeNode(e.map(r).concat(t===null?[]:y.createRestTypeNode(r(t)))),ys=({keySchema:e,valueSchema:t},{next:r})=>y.createExpressionWithTypeArguments(y.createIdentifier("Record"),[e,t].map(r)),gs=({_def:{left:e,right:t}},{next:r})=>{let o=[e,t].map(r);return o.every(g.default.isTypeLiteralNode)?y.createTypeLiteralNode(o.flatMap(({members:i})=>i)):y.createIntersectionTypeNode(o)},hs=({_def:e},{next:t})=>t(e.innerType),ue=e=>()=>y.createKeywordTypeNode(e),xs=(e,{next:t})=>t(e.unwrap()),bs=(e,{next:t})=>t(e.unwrap()),Ss=({_def:e},{next:t})=>t(e.innerType),Ts=({_def:e},{next:t,isResponse:r})=>t(e[r?"out":"in"]),Os=()=>y.createLiteralTypeNode(y.createNull()),Rs=(e,{makeAlias:t,next:r})=>t(e,()=>r(e.schema)),As=e=>{let t=e.unwrap(),r=y.createKeywordTypeNode(g.default.SyntaxKind.StringKeyword),o=y.createTypeReferenceNode("Buffer"),n=y.createUnionTypeNode([r,o]);return t instanceof Ot.z.ZodString?r:t instanceof Ot.z.ZodUnion?n:o},Ps=(e,{next:t})=>t(e.unwrap().shape.raw),Cs={ZodString:ue(g.default.SyntaxKind.StringKeyword),ZodNumber:ue(g.default.SyntaxKind.NumberKeyword),ZodBigInt:ue(g.default.SyntaxKind.BigIntKeyword),ZodBoolean:ue(g.default.SyntaxKind.BooleanKeyword),ZodAny:ue(g.default.SyntaxKind.AnyKeyword),[se]:ue(g.default.SyntaxKind.StringKeyword),[ie]:ue(g.default.SyntaxKind.StringKeyword),ZodNull:Os,ZodArray:as,ZodTuple:fs,ZodRecord:ys,ZodObject:is,ZodLiteral:ss,ZodIntersection:gs,ZodUnion:Ho,ZodDefault:hs,ZodEnum:ps,ZodNativeEnum:ls,ZodEffects:ds,ZodOptional:ms,ZodNullable:us,ZodDiscriminatedUnion:Ho,ZodBranded:xs,ZodCatch:Ss,ZodPipeline:Ts,ZodLazy:Rs,ZodReadonly:bs,[D]:As,[Y]:Ps},$e=(e,{brandHandling:t,ctx:r})=>de(e,{rules:{...t,...Cs},onMissing:()=>y.createKeywordTypeNode(g.default.SyntaxKind.AnyKeyword),ctx:r});var Rt=class{program=[];usage=[];registry=new Map;paths=[];aliases=new Map;ids={pathType:s.createIdentifier("Path"),methodType:s.createIdentifier("Method"),methodPathType:s.createIdentifier("MethodPath"),inputInterface:s.createIdentifier("Input"),posResponseInterface:s.createIdentifier("PositiveResponse"),negResponseInterface:s.createIdentifier("NegativeResponse"),responseInterface:s.createIdentifier("Response"),jsonEndpointsConst:s.createIdentifier("jsonEndpoints"),endpointTagsConst:s.createIdentifier("endpointTags"),providerType:s.createIdentifier("Provider"),implementationType:s.createIdentifier("Implementation"),clientClass:s.createIdentifier("ExpressZodAPIClient"),keyParameter:s.createIdentifier("key"),pathParameter:s.createIdentifier("path"),paramsArgument:s.createIdentifier("params"),methodParameter:s.createIdentifier("method"),accumulator:s.createIdentifier("acc"),provideMethod:s.createIdentifier("provide"),implementationArgument:s.createIdentifier("implementation"),headersProperty:s.createIdentifier("headers"),hasBodyConst:s.createIdentifier("hasBody"),undefinedValue:s.createIdentifier("undefined"),bodyProperty:s.createIdentifier("body"),responseConst:s.createIdentifier("response"),searchParamsConst:s.createIdentifier("searchParams"),exampleImplementationConst:s.createIdentifier("exampleImplementation"),clientConst:s.createIdentifier("client")};interfaces=[];makeAlias(t,r){let o=this.aliases.get(t)?.name?.text;if(!o){o=`Type${this.aliases.size+1}`;let n=s.createLiteralTypeNode(s.createNull());this.aliases.set(t,me(n,o)),this.aliases.set(t,me(r(),o))}return s.createTypeReferenceNode(o)}constructor({routing:t,brandHandling:r,variant:o="client",splitResponse:n=!1,optionalPropStyle:i={withQuestionMark:!0,withUndefined:!0}}){ce({routing:t,onEndpoint:(z,w,E)=>{let ge={makeAlias:this.makeAlias.bind(this),optionalPropStyle:i},Me=M(E,w,"input"),Ue=$e(z.getSchema("input"),{brandHandling:r,ctx:{...ge,isResponse:!1}}),k=n?M(E,w,"positive.response"):void 0,rr=z.getSchema("positive"),or=n?$e(rr,{brandHandling:r,ctx:{...ge,isResponse:!0}}):void 0,He=n?M(E,w,"negative.response"):void 0,nr=z.getSchema("negative"),sr=n?$e(nr,{brandHandling:r,ctx:{...ge,isResponse:!0}}):void 0,ir=M(E,w,"response"),Ko=k&&He?s.createUnionTypeNode([s.createTypeReferenceNode(k),s.createTypeReferenceNode(He)]):$e(rr.or(nr),{brandHandling:r,ctx:{...ge,isResponse:!0}});this.program.push(me(Ue,Me)),or&&k&&this.program.push(me(or,k)),sr&&He&&this.program.push(me(sr,He)),this.program.push(me(Ko,ir)),E!=="options"&&(this.paths.push(w),this.registry.set({method:E,path:w},{input:Me,positive:k,negative:He,response:ir,isJson:z.getMimeTypes("positive").includes(C.json),tags:z.getTags()}))}}),this.program.unshift(...this.aliases.values()),this.program.push(Jt(this.ids.pathType,this.paths)),this.program.push(Jt(this.ids.methodType,ko)),this.program.push(St(this.ids.methodPathType,_t([this.ids.methodType,this.ids.pathType])));let a=[s.createHeritageClause(N.default.SyntaxKind.ExtendsKeyword,[Qt(this.ids.methodPathType,N.default.SyntaxKind.AnyKeyword)])];this.interfaces.push({id:this.ids.inputInterface,kind:"input",props:[]}),n&&this.interfaces.push({id:this.ids.posResponseInterface,kind:"positive",props:[]},{id:this.ids.negResponseInterface,kind:"negative",props:[]}),this.interfaces.push({id:this.ids.responseInterface,kind:"response",props:[]});let p=[],d=[];for(let[{method:z,path:w},{isJson:E,tags:ge,...Me}]of this.registry){let Ue=No(z,w);for(let k of this.interfaces)k.kind in Me&&k.props.push(wo(Ue,Me[k.kind]));o!=="types"&&(E&&p.push(s.createPropertyAssignment(Ue,s.createTrue())),d.push(s.createPropertyAssignment(Ue,s.createArrayLiteralExpression(ge.map(k=>s.createStringLiteral(k))))))}for(let{id:z,props:w}of this.interfaces)this.program.push(jo(z,a,w));if(o==="types")return;let c=s.createVariableStatement(J,W(this.ids.jsonEndpointsConst,s.createObjectLiteralExpression(p))),u=s.createVariableStatement(J,W(this.ids.endpointTagsConst,s.createObjectLiteralExpression(d))),m=St(this.ids.providerType,s.createFunctionTypeNode(Lo({M:this.ids.methodType,P:this.ids.pathType}),bt({method:s.createTypeReferenceNode("M"),path:s.createTypeReferenceNode("P"),params:s.createIndexedAccessTypeNode(s.createTypeReferenceNode(this.ids.inputInterface),Yt)}),Eo(this.ids.responseInterface,Yt))),f=St(this.ids.implementationType,s.createFunctionTypeNode(void 0,bt({method:s.createTypeReferenceNode(this.ids.methodType),path:s.createKeywordTypeNode(N.default.SyntaxKind.StringKeyword),params:Qt(N.default.SyntaxKind.StringKeyword,N.default.SyntaxKind.AnyKeyword)}),vo())),T=s.createTemplateExpression(s.createTemplateHead(":"),[s.createTemplateSpan(this.ids.keyParameter,je)]),O=Xt(this.ids.paramsArgument,s.createCallExpression(s.createPropertyAccessExpression(this.ids.accumulator,"replace"),void 0,[T,s.createElementAccessExpression(this.ids.paramsArgument,this.ids.keyParameter)]),this.ids.pathParameter),Z=Xt(this.ids.paramsArgument,s.createConditionalExpression(s.createBinaryExpression(s.createCallExpression(s.createPropertyAccessExpression(this.ids.pathParameter,"indexOf"),void 0,[T]),N.default.SyntaxKind.GreaterThanEqualsToken,s.createNumericLiteral(0)),void 0,this.ids.accumulator,void 0,s.createObjectLiteralExpression([s.createSpreadAssignment(this.ids.accumulator),s.createPropertyAssignment(s.createComputedPropertyName(this.ids.keyParameter),s.createElementAccessExpression(this.ids.paramsArgument,this.ids.keyParameter))])),s.createObjectLiteralExpression()),x=Zo(this.ids.clientClass,zo([xt(this.ids.implementationArgument,s.createTypeReferenceNode(this.ids.implementationType),Co)]),[Io(this.ids.provideMethod,s.createTypeReferenceNode(this.ids.providerType),Wt([this.ids.methodParameter,this.ids.pathParameter,this.ids.paramsArgument],s.createCallExpression(s.createPropertyAccessExpression(s.createThis(),this.ids.implementationArgument),void 0,[this.ids.methodParameter,O,Z]),!0))]);this.program.push(c,u,m,f,x);let P=s.createPropertyAssignment(this.ids.methodParameter,s.createCallExpression(s.createPropertyAccessExpression(this.ids.methodParameter,"toUpperCase"),void 0,void 0)),X=s.createPropertyAssignment(this.ids.headersProperty,s.createConditionalExpression(this.ids.hasBodyConst,void 0,s.createObjectLiteralExpression([s.createPropertyAssignment(s.createStringLiteral("Content-Type"),s.createStringLiteral(C.json))]),void 0,this.ids.undefinedValue)),fe=s.createPropertyAssignment(this.ids.bodyProperty,s.createConditionalExpression(this.ids.hasBodyConst,void 0,s.createCallExpression(s.createPropertyAccessExpression(s.createIdentifier("JSON"),"stringify"),void 0,[this.ids.paramsArgument]),void 0,this.ids.undefinedValue)),Le=s.createVariableStatement(void 0,W(this.ids.responseConst,s.createAwaitExpression(s.createCallExpression(s.createIdentifier("fetch"),void 0,[s.createTemplateExpression(s.createTemplateHead("https://example.com"),[s.createTemplateSpan(this.ids.pathParameter,s.createTemplateMiddle("")),s.createTemplateSpan(this.ids.searchParamsConst,je)]),s.createObjectLiteralExpression([P,X,fe])])))),ye=s.createVariableStatement(void 0,W(this.ids.hasBodyConst,s.createLogicalNot(s.createCallExpression(s.createPropertyAccessExpression(s.createArrayLiteralExpression([s.createStringLiteral("get"),s.createStringLiteral("delete")]),"includes"),void 0,[this.ids.methodParameter])))),Ne=s.createVariableStatement(void 0,W(this.ids.searchParamsConst,s.createConditionalExpression(this.ids.hasBodyConst,void 0,s.createStringLiteral(""),void 0,s.createTemplateExpression(s.createTemplateHead("?"),[s.createTemplateSpan(s.createNewExpression(s.createIdentifier("URLSearchParams"),void 0,[this.ids.paramsArgument]),je)])))),[Ve,At]=["json","text"].map(z=>s.createReturnStatement(s.createCallExpression(s.createPropertyAccessExpression(this.ids.responseConst,z),void 0,void 0))),Ge=s.createIfStatement(s.createBinaryExpression(s.createTemplateExpression(Vt,[s.createTemplateSpan(this.ids.methodParameter,Gt),s.createTemplateSpan(this.ids.pathParameter,je)]),N.default.SyntaxKind.InKeyword,this.ids.jsonEndpointsConst),s.createBlock([Ve])),F=s.createVariableStatement(J,W(this.ids.exampleImplementationConst,Wt([this.ids.methodParameter,this.ids.pathParameter,this.ids.paramsArgument],s.createBlock([ye,Ne,Le,Ge,At]),!0),s.createTypeReferenceNode(this.ids.implementationType))),ee=s.createExpressionStatement(s.createCallExpression(s.createPropertyAccessExpression(this.ids.clientConst,this.ids.provideMethod),void 0,[s.createStringLiteral("get"),s.createStringLiteral("/v1/user/retrieve"),s.createObjectLiteralExpression([s.createPropertyAssignment("id",s.createStringLiteral("10"))])])),ke=s.createVariableStatement(void 0,W(this.ids.clientConst,s.createNewExpression(this.ids.clientClass,void 0,[this.ids.exampleImplementationConst])));this.usage.push(F,ke,ee)}printUsage(t){return this.usage.length?this.usage.map(r=>typeof r=="string"?r:tr(r,t)).join(`
`):void 0}print(t){let r=this.printUsage(t),o=r&&N.default.addSyntheticLeadingComment(N.default.addSyntheticLeadingComment(s.createEmptyStatement(),N.default.SyntaxKind.SingleLineCommentTrivia," Usage example:"),N.default.SyntaxKind.MultiLineCommentTrivia,`
${r}`);return this.program.concat(o||[]).map((n,i)=>tr(n,i<this.program.length?t:{...t,omitTrailingSemicolon:!0})).join(`

`)}async printFormatted({printerOptions:t,format:r}={}){let o=r;if(!o)try{let a=(await Ee("prettier")).format;o=p=>a(p,{filepath:"client.ts"})}catch{}let n=this.printUsage(t);this.usage=n&&o?[await o(n)]:this.usage;let i=this.print(t);return o?o(i):i}};var Do={dateIn:mr,dateOut:fr,file:rt,upload:br,raw:hr};0&&(module.exports={BuiltinLogger,DependsOnMethod,Documentation,DocumentationError,EndpointsFactory,InputValidationError,Integration,Middleware,MissingPeerError,OutputValidationError,ResultHandler,RoutingError,ServeStatic,arrayEndpointsFactory,arrayResultHandler,attachRouting,createConfig,createServer,defaultEndpointsFactory,defaultResultHandler,ez,getExamples,getMessageFromError,getStatusCodeFromError,testEndpoint,testMiddleware});
